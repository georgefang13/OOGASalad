{"states":{"INIT":{"init":"to pieceAvailable [ :dz ] [\n    make :moveset [ [ \"UpRight ] [ \"UpLeft ] [ \"DownRight ] [ \"DownLeft ] ]\n    ifelse == curplayer getplayer 0 [\n        make :moveset [ [ \"UpRight ] [ \"UpLeft ] ]\n    ] [\n        make :moveset [ [ \"DownRight ] [ \"DownLeft ] ]\n    ]\n\n    make :available [ ]\n    make :available_paths [ ]\n\n    foreach [ :path :moveset ] [\n        make :dz1 dzfollow :dz :path\n        if == null :dz1 [ continue ]\n\n        ifelse dzempty :dz1 [\n            additem :dz1 :available\n            additem aslist [ :path ] :available_paths\n        ] [\n            make :dz2 dzfollow :dz1 :path\n            if or == null :dz2 not dzempty :dz2 [ continue ]\n            if  != curplayer owner item 0 dzitems :dz1 [\n                additem :dz2 :available\n                additem aslist [ :path :path ] :available_paths\n            ]\n        ]\n\n    ]\n\n    make :ret aslist [ :available :available_paths ]\n\n    return :ret\n]\n","leave":"","setValue":"","to":"make :game_state_output \"CHOOSE_PIECE"},"CHOOSE_PIECE":{"init":"foreach [ :p fromplayer curplayer \"piece  ] [\n    make :possible pieceAvailable objdz :p\n    if != 0 len item 0 :possible [\n        makeavailable :p\n    ]\n]\n","leave":"","setValue":"make :piece_selected fromgame :game_state_input\nmake :old_dz objdz :piece_selected","to":"make :game_state_output \"CHOOSE_SQUARE"},"CHOOSE_SQUARE":{"init":"make :available_items pieceAvailable :old_dz\nmake :available item 0 :available_items\n\nif >= len :available 0 [\n    make :available_paths item 1 :available_items\n    makeallavailable :available\n]\n\n","leave":"","setValue":"make :dz fromgame :game_state_input\nmake :choice_num index :dz :available\nmake :chosen_path item :choice_num :available_paths\nmovepiece :piece_selected :dz\n\nif == 2 len :chosen_path [\n    make :dir item 0 :chosen_path\n    make :dz_cross dzfollow :old_dz :dir\n    make :piece item 0 dzitems :dz_cross\n    if != null :piece [\n        removepiece :piece\n    ]\n]\n","to":"make :game_state_output \"DONE"},"DONE":{"init":"","leave":"gotonextplayer","setValue":"","to":"make :game_state_output \"INIT"}},"goals":[]}